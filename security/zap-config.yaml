---
# ZAP Security Scan Config for DRACIN
env:
  contexts:
    - name: "DRACIN API"
      urls:
        - "https://dracinshort.xyz/api/*"
      includePaths:
        - "https://dracinshort.xyz/api/.*"
      excludePaths:
        - "https://dracinshort.xyz/api/admin/.*"
      authentication:
        method: "json"
        parameters:
          loginPageUrl: "https://dracinshort.xyz/api/auth/login"
          loginRequestBody: '{"username":"zaptest","password":"ZapTest123!"}'
      users:
        - name: "test-user"
          credentials:
            username: "zaptest"
            password: "ZapTest123!"

  parameters:
    failOnError: true
    progressToStdout: true

  jobs:
    - type: spider
      parameters:
        maxDuration: 5
        maxDepth: 3
        url: "https://dracinshort.xyz/api"

    - type: spiderAjax
      parameters:
        maxDuration: 5
        url: "https://dracinshort.xyz"

    - type: activeScan
      parameters:
        maxRuleDurationInMins: 10
        maxScanDurationInMins: 30
      policyDefinition:
        rules:
          - id: 40012  # XSS Reflected
            strength: "HIGH"
          - id: 40014  # XSS Persistent
            strength: "HIGH"
          - id: 40018  # SQL Injection
            strength: "HIGH"
          - id: 40019  # SQL Injection (MySQL)
            strength: "MEDIUM"
          - id: 40020  # SQL Injection (Hypersonic)
            strength: "LOW"
          - id: 40021  # SQL Injection (Oracle)
            strength: "LOW"
          - id: 40022  # SQL Injection (PostgreSQL)
            strength: "HIGH"
          - id: 90019  # Server Side Code Injection
            strength: "HIGH"
          - id: 90020  # Remote OS Command Injection
            strength: "HIGH"

    - type: report
      parameters:
        template: "traditional-html"
        reportDir: "./results"
        reportFile: "zap-report"
